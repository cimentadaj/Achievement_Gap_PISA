filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`)) +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
geom_hline(yintercept = 0, linetype = "longdash") +
scale_y_continuous(breaks = seq(-160, 160, 40)) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
perc_graph <- function(df, title) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`)) +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
geom_hline(yintercept = 0, linetype = "longdash") +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 % change from year 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
perc_graph(top_bottom_perc, "90/10 gap % change from year 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
m1 <-
perc_graph(top_bottom_perc, "90/10 gap % change from year 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
m2 <- perc_graph(top_mid_perc, "90/50")
m3 <- perc_graph(mid_bottom_perc, "50/10")
gridExtra::grid.arrange(m1, m2, m3, nrow = 1)
m1 <-
perc_graph(top_bottom_perc, "90/10 gap % change from year 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
perc_graph <- function(df, title) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`)) +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
geom_hline(yintercept = 0, linetype = "longdash") +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
m1
perc_graph <- function(df, title, subtitle) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`)) +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
geom_hline(yintercept = 0, linetype = "longdash") +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 gap % change from year 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`)) +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
geom_hline(yintercept = 0, linetype = "longdash") +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 gap % change from year 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, colour = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, fill = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, fill = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
scale_fill_discrete(guide = NULL) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, fill = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
scale_fill_discrete(guide = FALSE) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015") +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, fill = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4)
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
scale_fill_discrete(guide = FALSE) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015")
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, fill = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`), alpha = 0.4) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
scale_fill_discrete(guide = FALSE) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015")
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, fill = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`, colour = `Average % difference` > 0), alpha = 0.4) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
scale_fill_discrete(guide = FALSE) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015")
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, fill = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.3) +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`,
colour = `Average % difference` > 0), alpha = 0.4) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
scale_fill_discrete(guide = FALSE) +
scale_colour_discrete(guide = FALSE) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015")
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, fill = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.1) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.1) +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`,
colour = `Average % difference` > 0), alpha = 0.4) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
scale_fill_discrete(guide = FALSE) +
scale_colour_discrete(guide = FALSE) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015")
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, fill = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.2) +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`,
colour = `Average % difference` > 0), alpha = 0.4) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
scale_fill_discrete(guide = FALSE) +
scale_colour_discrete(guide = FALSE) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015")
perc_graph(top_bottom_perc, "90/10 achievement gap", "Percentage change from 2000 to 2015")
perc_graph <- function(df, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == "math") %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, fill = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.2) +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`,
colour = `Average % difference` > 0), alpha = 0.4) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
scale_fill_discrete(guide = FALSE) +
scale_colour_discrete(guide = FALSE) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph <- function(df, test, title, subtitle = NULL) {
df %>%
enframe(name = "country") %>%
unnest(value) %>%
filter(country %in% countries) %>%
select(-country1, -years_available) %>%
mutate(diff_95_lower = perc_diff - 2*sd_year,
diff_95_upper = perc_diff + 2*sd_year) %>%
setNames(c("Country", "Type of test", "Average % difference", "Average SD",
"Lower 50% bound", "Upper 50% bound", "Lower 95% bound", "Upper 95% bound")) %>%
filter(`Type of test` == test) %>%
arrange(`Average % difference`) %>%
mutate(Country = ordered(forcats::as_factor(Country)),
Country_num = as.numeric(Country)) %>%
ggplot(aes(Country, `Average % difference`, fill = `Average % difference` > 0)) +
geom_hline(yintercept = 0, linetype = "longdash") +
geom_point() +
geom_ribbon(aes(x = Country_num, ymin = `Lower 95% bound`, ymax = `Upper 95% bound`), alpha = 0.3) +
geom_ribbon(aes(x = Country_num, ymin = `Lower 50% bound`, ymax = `Upper 50% bound`), alpha = 0.2) +
geom_linerange(aes(ymin = 0, ymax = `Average % difference`,
colour = `Average % difference` > 0), alpha = 0.4) +
scale_y_continuous(name = "Avg % increase/decrease",breaks = seq(-160, 160, 40)) +
scale_fill_discrete(guide = FALSE) +
scale_colour_discrete(guide = FALSE) +
coord_cartesian(ylim = c(-160, 160)) +
ggtitle(title, subtitle) +
ggthemes::theme_few() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
perc_graph(top_bottom_perc, "math", "90/10 achievement gap", "Percentage change from 2000 to 2015")
perc_graph(top_bottom_perc, "read", "90/10 achievement gap", "Percentage change from 2000 to 2015")
getwd()
getwd()
list.files(getwd())
