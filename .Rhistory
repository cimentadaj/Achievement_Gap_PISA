colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line() +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles"
# labels = seq(100, 0, -25) %>% paste0("%")
) +
# scale_linetype_discrete(
#   name = "Vocational index \n quantiles",
#   labels = seq(100, 0, -25) %>% paste0("%")
# ) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line() +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction
head(data_interaction)
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line() +
geom_ribbon(ymin = ymin, ymax = ymax) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line() +
geom_ribbon(aes(ymin = ymin, ymax = ymax)) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line() +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour))
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line() +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour, colour = NULL, alpha = 0.3)) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line() +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour, colour = NULL, alpha = 0.1)) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line(size = 3) +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour, colour = NULL, alpha = 0.1)) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line(size = 1) +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour, colour = NULL, alpha = 0.1)) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour))
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour))
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line(size = 1) +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour, colour = NULL, alpha = 0.05)) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line(size = 1) +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour, colour = NULL, alpha = 0.05)) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line(size = 1) +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour, colour = NULL), alpha = 0.05) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line(size = 1) +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour, colour = NULL), alpha = 0.1) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line(size = 1) +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour, colour = NULL), alpha = 0.3) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y, colour = colour, linetype = linetype)) +
geom_line(size = 1) +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour, colour = NULL), alpha = 0.4) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = group %>% as.factor,
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y)) +
geom_line(aes(colour = colour, linetype = linetype), size = 1) +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour), alpha = 0.4) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
distinct(group, colour)
order_colour <-
data_interaction %>%
distinct(group, colour) %>%
mutate(colour = colour) %>%
pull(colour)
data_interaction %>%
mutate(linetype = factor(group, levels = 5:1),
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y)) +
geom_line(aes(colour = colour, linetype = linetype), size = 1) +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour), alpha = 0.4) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(100, 0, -25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
data_interaction %>%
mutate(linetype = factor(group, levels = 5:1),
colour = factor(colour, levels = order_colour)) %>%
ggplot(aes(x, y)) +
geom_line(aes(colour = colour, linetype = linetype), size = 1) +
geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = colour), alpha = 0.4) +
labs(x = "Tracking Index (SD)", y = "90/10 Achievement gap (SD)") +
scale_colour_discrete(
name = "Vocational index \n quantiles",
labels = seq(0, 100, 25) %>% paste0("%")
) +
scale_linetype_discrete(
name = "Vocational index \n quantiles",
labels = seq(0, 100, 25) %>% paste0("%")
) +
scale_fill_discrete(guide = FALSE) +
ggtitle("Interaction between Tracking and Vocational index")
gaps <- c("90th/10th SES gap", "80th/20th SES gap", "70th/30th SES gap")
all_gaps_models <-
map(gaps, function(gap) {
ready_data_age <-
dif_data(complete_gaps, tracking_data, which_gap = gap) %>%
mutate(age_selection = ifelse(selage >= 15, 1, 0) %>% as.factor)
mod_tracking <-
brms::brm(
difference ~
ztrack +
zvoc +
ztrack:zvoc +
(1|year), family = gaussian(),
data = ready_data_age,
warmup = 1000, iter = 2000, chains = 5,
control = list(adapt_delta = 0.95)
)
mod_tracking
})
model_data_merged <-
map(all_gaps_models, ~ fixef(.x)[, c(1, 3, 4)] %>% as_tibble) %>%
setNames(gaps) %>%
enframe() %>%
unnest(value) %>%
mutate_if(is_double, round, 2) %>%
transmute(model = name,
terms = all_gaps_models[[1]] %>% fixef %>% row.names %>% rep(3),
estimate = Estimate,
lower = `2.5%ile`,
upper = `97.5%ile`)
model_data_merged %>%
ggplot(aes(terms, estimate, colour = model)) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1) +
geom_point() +
geom_hline(yintercept = 0) +
scale_colour_discrete(name = NULL) +
scale_y_continuous(limits = c(-0.5, 2)) +
scale_x_discrete(labels = c("Intercept",
"Tracking Index",
"Vocational * Tracking Index",
"Vocational Index")) +
labs(y = "Estimate from linear model", x = "Predictors") +
ggtitle("Estimation of tracking/vocational models for different gaps") +
coord_flip()
model_data_merged %>%
ggplot(aes(terms, estimate, colour = model, shape = model)) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1) +
geom_point() +
geom_hline(yintercept = 0) +
scale_colour_discrete(name = NULL) +
scale_y_continuous(limits = c(-0.5, 2)) +
scale_x_discrete(labels = c("Intercept",
"Tracking Index",
"Vocational * Tracking Index",
"Vocational Index")) +
labs(y = "Estimate from linear model", x = "Predictors") +
ggtitle("Estimation of tracking/vocational models for different gaps") +
coord_flip()
model_data_merged %>%
ggplot(aes(terms, estimate, colour = model, shape = model)) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1) +
geom_point() +
geom_hline(yintercept = 0) +
scale_colour_discrete(name = NULL) +
scale_y_continuous(limits = c(-0.5, 2)) +
scale_x_discrete(labels = c("Intercept",
"Tracking Index",
"Vocational * Tracking Index",
"Vocational Index")) +
scale_colour_discrete(name = "") +
scale_shape_discrete(name = "") +
labs(y = "Estimate from linear model", x = "Predictors") +
ggtitle("Estimation of tracking/vocational models for different gaps") +
coord_flip()
model_data_merged %>%
ggplot(aes(terms, estimate, colour = model, shape = model)) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1) +
geom_point(size = 2) +
geom_hline(yintercept = 0) +
scale_colour_discrete(name = NULL) +
scale_y_continuous(limits = c(-0.5, 2)) +
scale_x_discrete(labels = c("Intercept",
"Tracking Index",
"Vocational * Tracking Index",
"Vocational Index")) +
scale_colour_discrete(name = "") +
scale_shape_discrete(name = "") +
labs(y = "Estimate from linear model", x = "Predictors") +
ggtitle("Estimation of tracking/vocational models for different gaps") +
coord_flip()
model_data_merged %>%
ggplot(aes(terms, estimate, colour = model, shape = model)) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1) +
geom_point(size = 2) +
geom_hline(yintercept = 0) +
scale_y_continuous(limits = c(-0.5, 2)) +
scale_x_discrete(labels = c("Intercept",
"Tracking Index",
"Vocational * Tracking Index",
"Vocational Index")) +
scale_colour_discrete(name = NULL) +
scale_shape_discrete(name = NULL) +
labs(y = "Estimate from linear model", x = "Predictors") +
ggtitle("Estimation of tracking/vocational models for different gaps") +
coord_flip()
model_data_merged %>%
ggplot(aes(terms, estimate, colour = model, shape = model)) +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1) +
geom_point(size = 2) +
geom_hline(yintercept = 0) +
scale_y_continuous(limits = c(-0.5, 2)) +
scale_x_discrete(labels = c("Intercept",
"Tracking Index",
"Vocational * Tracking Index",
"Vocational Index")) +
scale_colour_discrete(name = NULL) +
scale_shape_discrete(name = NULL) +
labs(y = "Estimate from linear model", x = "Predictors") +
ggtitle("Estimation of tracking/vocational models for different gaps") +
coord_flip()
model_data_merged %>%
ggplot(aes(terms, estimate, colour = model, shape = model)) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1) +
geom_point(size = 2) +
geom_hline(yintercept = 0) +
scale_y_continuous(limits = c(-0.5, 2)) +
scale_x_discrete(labels = c("Intercept",
"Tracking Index",
"Vocational * Tracking Index",
"Vocational Index")) +
scale_colour_discrete(name = NULL) +
scale_shape_discrete(name = NULL) +
labs(y = "Estimate from linear model", x = "Predictors") +
ggtitle("Estimation of tracking/vocational models for different gaps") +
coord_flip()
model_data_merged %>%
ggplot(aes(terms, estimate, colour = model, shape = model)) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1) +
geom_point(size = 2.5) +
geom_hline(yintercept = 0) +
scale_y_continuous(limits = c(-0.5, 2)) +
scale_x_discrete(labels = c("Intercept",
"Tracking Index",
"Vocational * Tracking Index",
"Vocational Index")) +
scale_colour_discrete(name = NULL) +
scale_shape_discrete(name = NULL) +
scale_er
labs(y = "Estimate from linear model", x = "Predictors") +
ggtitle("Estimation of tracking/vocational models for different gaps") +
coord_flip()
model_data_merged %>%
ggplot(aes(terms, estimate, colour = model, shape = model)) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1) +
geom_point(size = 2.5) +
geom_hline(yintercept = 0) +
scale_y_continuous(limits = c(-0.5, 2)) +
scale_x_discrete(labels = c("Intercept",
"Tracking Index",
"Vocational * Tracking Index",
"Vocational Index")) +
scale_colour_discrete(name = NULL) +
scale_shape_discrete(name = NULL) +
scale_er
model_data_merged %>%
ggplot(aes(terms, estimate, colour = model, shape = model)) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1) +
geom_point(size = 2.5) +
geom_hline(yintercept = 0) +
scale_y_continuous(limits = c(-0.5, 2)) +
scale_x_discrete(labels = c("Intercept",
"Tracking Index",
"Vocational * Tracking Index",
"Vocational Index")) +
scale_colour_discrete(name = NULL) +
scale_shape_discrete(name = NULL) +
model_data_merged %>%
ggplot(aes(terms, estimate, colour = model, shape = model)) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1) +
geom_point(size = 2.5) +
geom_hline(yintercept = 0) +
scale_y_continuous(limits = c(-0.5, 2)) +
scale_x_discrete(labels = c("Intercept",
"Tracking Index",
"Vocational * Tracking Index",
"Vocational Index")) +
scale_colour_discrete(name = NULL) +
scale_shape_discrete(name = NULL) +
labs(y = "Estimate from linear model", x = "Predictors") +
ggtitle("Estimation of tracking/vocational models for different gaps") +
coord_flip()
new_data %>%
left_join(sum_ready_data) %>%
mutate(age_selection = ifelse(age_selection == 1, ">= 15", "< 15")) %>%
ggplot(aes(num_tracks, avg_diff, fill = num_tracks)) +
geom_col(aes(y = pred, colour = num_tracks)) +
geom_errorbar(aes(ymin = pred_low, ymax = pred_high), width = 0.2) +
geom_point(colour = "red", shape = 8) +
geom_errorbar(aes(ymin = diff_low, ymax = diff_high), width = 0.2, colour = "red") +
facet_wrap(country ~ age_selection) +
scale_y_continuous(name = "90/10 SD gap", limits = c(0, 4)) +
scale_alpha(guide = F) +
scale_x_discrete(name = "Number of tracks", labels = c("> 1 track", "1 track")) +
scale_fill_manual(values = c("white", "white"), guide = F) +
scale_colour_manual(values = c("black", "black"), guide = F) +
ggtitle("Predicted 90/10 gap for different combinations of number of tracks and age of selection")
700 - 300
