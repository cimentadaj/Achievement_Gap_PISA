gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
# gather(lower_bound, lower, matches("\\d_lower")) %>%
# gather(upper_bound, upper, matches("\\d_upper"))
ggplot(aes(as.factor(wave), gap_size, group = ses, colour = ses)) +
# geom_line(stat = "smooth", method = "lm", aes(group = 1),
#           formula = y ~ splines::ns(x, 3), linetype = "longdash",
#           colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
geom_line(aes(group = ses), alpha = 0.4) +
geom_point(size = 0.5, alpha = 0.4) +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
# gather(lower_bound, lower, matches("\\d_lower")) %>%
# gather(upper_bound, upper, matches("\\d_upper"))
ggplot(aes(as.factor(wave), gap_size, group = ses, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(alpha = 0.4) +
# geom_line(stat = "smooth", method = "lm", aes(group = 1),
#           formula = y ~ splines::ns(x, 3), linetype = "longdash",
#           colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
# gather(lower_bound, lower, matches("\\d_lower")) %>%
# gather(upper_bound, upper, matches("\\d_upper"))
ggplot(aes(as.factor(wave), gap_size, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(aes(group = ses), alpha = 0.4) +
# geom_line(stat = "smooth", method = "lm", aes(group = 1),
#           formula = y ~ splines::ns(x, 3), linetype = "longdash",
#           colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
# gather(lower_bound, lower, matches("\\d_lower")) %>%
# gather(upper_bound, upper, matches("\\d_upper"))
ggplot(aes(as.factor(wave), gap_size, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(aes(group = as.character(ses)), alpha = 0.4) +
# geom_line(stat = "smooth", method = "lm", aes(group = 1),
#           formula = y ~ splines::ns(x, 3), linetype = "longdash",
#           colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
# gather(lower_bound, lower, matches("\\d_lower")) %>%
# gather(upper_bound, upper, matches("\\d_upper"))
ggplot(aes(as.factor(wave), gap_size, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(aes(group = as.factor(ses)), alpha = 0.4) +
# geom_line(stat = "smooth", method = "lm", aes(group = 1),
#           formula = y ~ splines::ns(x, 3), linetype = "longdash",
#           colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
# gather(lower_bound, lower, matches("\\d_lower")) %>%
# gather(upper_bound, upper, matches("\\d_upper"))
ggplot(aes(as.factor(wave), gap_size, colour = ses)) +
geom_line(aes(group = as.factor(ses)), alpha = 0.4) +
# geom_line(stat = "smooth", method = "lm", aes(group = 1),
#           formula = y ~ splines::ns(x, 3), linetype = "longdash",
#           colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
# gather(lower_bound, lower, matches("\\d_lower")) %>%
# gather(upper_bound, upper, matches("\\d_upper"))
ggplot(aes(as.factor(wave), gap_size, colour = as.factor(ses))) +
geom_line(aes(group = as.factor(ses)), alpha = 0.4) +
# geom_line(stat = "smooth", method = "lm", aes(group = 1),
#           formula = y ~ splines::ns(x, 3), linetype = "longdash",
#           colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
# gather(lower_bound, lower, matches("\\d_lower")) %>%
# gather(upper_bound, upper, matches("\\d_upper"))
ggplot(aes(as.factor(wave), gap_size, group = as.factor(ses), colour = as.factor(ses))) +
geom_line(alpha = 0.4) +
# geom_line(stat = "smooth", method = "lm", aes(group = 1),
#           formula = y ~ splines::ns(x, 3), linetype = "longdash",
#           colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses))
View(complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)))
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses))
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
filter(complete.cases(.))
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
filter(complete.cases(.)) %>%
# gather(lower_bound, lower, matches("\\d_lower")) %>%
# gather(upper_bound, upper, matches("\\d_upper"))
ggplot(aes(as.factor(wave), gap_size, group = as.factor(ses), colour = as.factor(ses))) +
geom_line(alpha = 0.4) +
# geom_line(stat = "smooth", method = "lm", aes(group = 1),
#           formula = y ~ splines::ns(x, 3), linetype = "longdash",
#           colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
filter(complete.cases(.)) %>%
# gather(lower_bound, lower, matches("\\d_lower")) %>%
# gather(upper_bound, upper, matches("\\d_upper"))
ggplot(aes(as.factor(wave), gap_size, group = ses, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(alpha = 0.4) +
# geom_line(stat = "smooth", method = "lm", aes(group = 1),
#           formula = y ~ splines::ns(x, 3), linetype = "longdash",
#           colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
complete_data_topbottom %>%
filter(country %in% countries) %>%
mutate(country = factor(country, levels = ordered_cnt, ordered = TRUE)) %>%
select(wave, country, matches("*._math$")) %>%
gather(ses, gap_size, matches("^\\d_mean_math$")) %>%
separate(ses, c("ses", "delete"), sep = 2) %>%
mutate(ses = gsub("_", "", ses)) %>%
filter(complete.cases(.)) %>%
# gather(lower_bound, lower, matches("\\d_lower")) %>%
# gather(upper_bound, upper, matches("\\d_upper"))
ggplot(aes(as.factor(wave), gap_size, group = ses, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(alpha = 0.4) +
geom_line(stat = "smooth", method = "lm", aes(group = 1),
formula = y ~ splines::ns(x, 3), linetype = "longdash",
colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
tibble(country = "fake_country", years = seq(2000, 2025, 5))
tibble(country = "fake_country", years = seq(2000, 2025, 2))
tibble(country = "fake_country", years = seq(2000, 2025, 2), ses = rep(c("lower", "upper"), each = 13))
tibble(country = "fake_country", years = rep(seq(2000, 2025, 2), 2), ses = rep(c("lower", "upper"), each = 13))
lower <- seq(1, 13, 1)
lower
lower <- seq(13, 1, -1)
upper <- seq(1, 26, 5)
lower
upper
lower <- seq(13, 1, -1)
upper <- seq(1, 26, 2)
lower
upper
tibble(country = "fake_country",
years = rep(seq(2000, 2025, 2), 2),
ses = rep(c("lower", "upper"), each = 13),
value = c(lower, upper))
df %>%
ggplot(aes(as.factor(years), value, group = ses, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(alpha = 0.4) +
geom_line(stat = "smooth", method = "lm", aes(group = 1),
formula = y ~ splines::ns(x, 3), linetype = "longdash",
colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
df <- tibble(country = "fake_country",
years = rep(seq(2000, 2025, 2), 2),
ses = rep(c("lower", "upper"), each = 13),
value = c(lower, upper))
df %>%
ggplot(aes(as.factor(years), value, group = ses, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(alpha = 0.4) +
geom_line(stat = "smooth", method = "lm", aes(group = 1),
formula = y ~ splines::ns(x, 3), linetype = "longdash",
colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
lower <- seq(13, 1, -1)
upper <- seq(100, 126, 2)
df <- tibble(country = "fake_country",
years = rep(seq(2000, 2025, 2), 2),
ses = rep(c("lower", "upper"), each = 13),
value = c(lower, upper))
df %>%
ggplot(aes(as.factor(years), value, group = ses, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(alpha = 0.4) +
geom_line(stat = "smooth", method = "lm", aes(group = 1),
formula = y ~ splines::ns(x, 3), linetype = "longdash",
colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
upper
lower
length(upper)
lower <- seq(13, 1, -1)
upper <- seq(100, 123, 2)
length(upper)
lower <- seq(13, 1, -1)
upper <- seq(100, 124, 2)
length(upper)
df <- tibble(country = "fake_country",
years = rep(seq(2000, 2025, 2), 2),
ses = rep(c("lower", "upper"), each = 13),
value = c(lower, upper))
df %>%
ggplot(aes(as.factor(years), value, group = ses, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(alpha = 0.4) +
geom_line(stat = "smooth", method = "lm", aes(group = 1),
formula = y ~ splines::ns(x, 3), linetype = "longdash",
colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
upper <- seq(100, 128, 4)
length(upper)
upper <- seq(100, 136, 4)
length(upper)
upper <- seq(100, 139, 4)
length(upper)
upper <- seq(100, 146, 4)
length(upper)
upper <- seq(100, 149, 4)
length(upper)
lower <- seq(13, 1, -1)
length(lower)
df <- tibble(country = "fake_country",
years = rep(seq(2000, 2025, 2), 2),
ses = rep(c("lower", "upper"), each = 13),
value = c(lower, upper))
df %>%
ggplot(aes(as.factor(years), value, group = ses, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(alpha = 0.4) +
geom_line(stat = "smooth", method = "lm", aes(group = 1),
formula = y ~ splines::ns(x, 3), linetype = "longdash",
colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
upper <- seq(100, 230, 10)
length(upper)
lower <- seq(13, 1, -1)
upper <- seq(100, 220, 10)
lower <- seq(13, 1, -1)
length(upper)
df <- tibble(country = "fake_country",
years = rep(seq(2000, 2025, 2), 2),
ses = rep(c("lower", "upper"), each = 13),
value = c(lower, upper))
df %>%
ggplot(aes(as.factor(years), value, group = ses, colour = ses)) +
geom_point(size = 0.5, alpha = 0.4) +
geom_line(alpha = 0.4) +
geom_line(stat = "smooth", method = "lm", aes(group = 1),
formula = y ~ splines::ns(x, 3), linetype = "longdash",
colour = "black") +
# geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.1, alpha = 0.4) +
# geom_hline(yintercept = 0, linetype = "longdash") +
# coord_cartesian(ylim = c(0, 3)) +
facet_wrap(~ country)
setwd("./Downloads/mexico/Data/")
getwd()
data <- read_csv("./Downloads/mexico/Data/mex_states.csv")
library(tidyverse)
data <- read_csv("./Downloads/mexico/Data/mex_states.csv")
data <- read_csv("/Users/cimentadaj/Downloads/mexico/Data/mex_states.csv")
data %>%
group_by(Year, StateName) %>%
summarize(sum = sum(Gap)) %>%
filter(Year == 1990) %>%
ggplot(aes(reorder(StateName, sum), sum)) +
geom_col() +
coord_flip()
?ggsave
ggsave("plot1.png", path = "/Users/cimentadaj/Downloads/mexico/Data/")
new_data <-
data %>%
mutate(cause_recode = dplyr::recode(CauseName,
'Homicide' = 'Non-natural',
'Other' = 'Non-natural',
'Road traffic' = 'Non-natural',
'Suicide' = 'Non-natural',
'Diabetes' = 'Natural',
'IHD' = 'Natural',
'Cirrhosis' = 'Natural',
'Lung cancer' = 'Natural'
),
year_groups = car::recode(Year,
"1990:1994 = '90-94';
1995:1999 = '95-99';
2000:2004 = '00-04';
2005:2009 = '05-09';
2010:2015 = '10-15'")) %>%
group_by(year_groups, Age, cause_recode) %>%
summarize(avg_gap = mean(Gap))
new_data %>%
ggplot(aes(x = Age, y = avg_gap,
group = year_groups,
colour = year_groups)) +
geom_line() +
facet_wrap(~ cause_recode)
save_fun <- function(number) {
ggsave(paste0("plot", number, ".png"), path = "/Users/cimentadaj/Downloads/mexico/Data/")
}
save_fun(1)
new_data %>%
ggplot(aes(x = Age, y = avg_gap,
group = year_groups,
colour = year_groups)) +
geom_line() +
facet_wrap(~ cause_recode)
save_fun(2)
other_new_data <-
data %>%
mutate(cause_recode = dplyr::recode(CauseName,
# 'Homicide' = 'Non-natural',
# 'Other' = 'Non-natural',
'Road traffic' = 'Non-natural',
'Suicide' = 'Non-natural',
'Diabetes' = 'Natural + HIV',
'IHD' = 'Natural + HIV',
'Cirrhosis' = 'Natural + HIV',
'Lung cancer' = 'Natural + HIV',
'HIV' = 'Natural + HIV'
),
year_groups = car::recode(Year,
"1990:1994 = '90-94';
1995:1999 = '95-99';
2000:2004 = '00-04';
2005:2009 = '05-09';
2010:2015 = '10-15'")) %>%
group_by(StateName, Year, year_groups, Age, cause_recode) %>%
summarize(avg_gap = mean(Gap))
other_new_data %>%
group_by(StateName, cause_recode) %>%
summarize(variance = sd(avg_gap)) %>%
ggplot(aes(reorder(StateName, variance), variance)) +
geom_point() +
coord_flip() +
facet_wrap(~ cause_recode)
save(3)
save_fun(3)
other_new_data %>%
group_by(cause_recode, year_groups) %>%
summarize(variance = sd(avg_gap)) %>%
group_by(cause_recode) %>%
summarize(avg_var = mean(variance)) %>%
ggplot(aes(cause_recode, avg_var)) +
geom_col() +
coord_flip()
save_fun(4)
library(geofacet)
mex_grid <- structure(list(row = c("4", "1", "2", "3", "2", "7", "6", "6",
"3", "6", "5", "7", "5", "5", "6", "6", "6", "3", "4", "7", "6",
"5", "7", "3", "4", "1", "7", "5", "3", "7", "6", "4"), col = c(5,
1, 1, 5, 3, 10, 11, 4, 4, 7, 5, 7, 7, 4, 5, 6, 8, 6, 4, 8, 9,
6, 12, 3, 7, 2, 11, 8, 7, 9, 12, 6), code = c("AGS", "BCN", "BCS",
"CDZ", "CHH", "CHP", "CMP", "COL", "DRN", "DTD", "GNJ", "GRR",
"HDL", "JLS", "MDO", "MEX", "MRL", "NLE", "NYR", "OAX", "PUE",
"QDA", "QRO", "SIN", "SLP", "SON", "TBS", "TLX", "TML", "VLL",
"YCT", "ZCT"), name = c("Aguascalientes", "Baja California",
"Baja California Sur", "Coahuila", "Chihuahua", "Chiapas", "Campeche",
"Colima", "Durango", "Distrito Federal", "Guanajuato", "Guerrero",
"Hidalgo", "Jalisco", "Michoacan", "Mexico", "Morelos", "Nuevo Leon",
"Nayarit", "Oaxaca", "Puebla", "Queretaro", "Quintana Roo", "Sinaloa",
"San Luis Potosi", "Sonora", "Tabasco", "Tlaxcala", "Tamaulipas",
"Veracruz", "Yucatan", "Zacatecas")), class = "data.frame", .Names = c("row",
"col", "code", "name"), row.names = c(NA, -32L))
library(gganimate)
other_new_data %>%
ungroup(StateName) %>%
mutate(StateName =
dplyr::recode(StateName,
"México" = "Mexico",
'Michoacán' = 'Michoacan',
'Nuevo León' = 'Nuevo Leon',
'Querétaro' = 'Queretaro',
'San Luis Potosí' = 'San Luis Potosi',
'Yucatán' = 'Yucatan')) %>%
group_by(StateName, Year, Age) %>%
mutate(total_gap = sum(avg_gap),
perc_gap = avg_gap / total_gap * 100) %>%
ggplot(aes(Year, avg_gap, fill = cause_recode, frame = Year)) +
geom_col() +
scale_y_continuous(name = "Years of life lost across \n ages 15-50") +
scale_fill_discrete(name = "Causes") +
coord_cartesian(ylim = c(0, 2)) +
facet_geo(~ StateName, grid = mex_grid, label = "name")
save_fun(5)
other_new_data %>%
ungroup(StateName) %>%
mutate(StateName =
dplyr::recode(StateName,
"México" = "Mexico",
'Michoacán' = 'Michoacan',
'Nuevo León' = 'Nuevo Leon',
'Querétaro' = 'Queretaro',
'San Luis Potosí' = 'San Luis Potosi',
'Yucatán' = 'Yucatan')) %>%
filter(Year == 1998) %>%
ggplot(aes(Age, avg_gap, fill = cause_recode, frame = as.factor(Year))) +
geom_col() +
scale_y_continuous(name = "Years of life lost across \n ages 15-50") +
scale_fill_discrete(name = "Causes") +
coord_cartesian(ylim = c(0, 2))
save_fun(6)
